# å·¥å…·å®ç°ç³»ç»Ÿ - æ ¸å¿ƒå·¥å…·é›†æˆè§„èŒƒ

## ğŸ¯ ç³»ç»Ÿå®šä½ä¸èŒè´£

å·¥å…·å®ç°ç³»ç»Ÿæ˜¯Claude Codeçš„æ ¸å¿ƒæ‰§è¡Œå¼•æ“ï¼Œè´Ÿè´£å°†AIæŒ‡ä»¤è½¬æ¢ä¸ºå…·ä½“çš„ç³»ç»Ÿæ“ä½œã€‚åŸºäºæ·±åº¦é€†å‘åˆ†æï¼Œæœ¬ç³»ç»Ÿç²¾ç¡®è¿˜åŸäº†Claude Codeçš„15ä¸ªæ ¸å¿ƒå·¥å…·ï¼Œæ¯ä¸ªå·¥å…·éƒ½å…·å¤‡å®Œæ•´çš„éªŒè¯æœºåˆ¶ã€å¹¶å‘æ§åˆ¶å’Œå®‰å…¨ä¿éšœã€‚

### æ ¸å¿ƒèŒè´£
- **å·¥å…·æ³¨å†Œä¸å‘ç°**: åŠ¨æ€å·¥å…·æ³¨å†Œã€æ™ºèƒ½å·¥å…·åŒ¹é…ã€ç‰ˆæœ¬å…¼å®¹æ€§ç®¡ç†
- **æ‰§è¡Œå¼•æ“**: å¹¶å‘/ä¸²è¡Œæ‰§è¡Œè°ƒåº¦ã€èµ„æºç®¡ç†ã€æ€§èƒ½ä¼˜åŒ–
- **å®‰å…¨éªŒè¯**: 9å±‚éªŒè¯æœºåˆ¶ã€æƒé™æ§åˆ¶ã€æ²™ç®±éš”ç¦»
- **MCPé›†æˆ**: å¤–éƒ¨å·¥å…·åè®®æ”¯æŒã€æ’ä»¶ç”Ÿæ€æ‰©å±•

## ğŸ“‹ æ ¸å¿ƒå·¥å…·æ¸…å•

### æ–‡ä»¶æ“ä½œå·¥å…·
1. **Readå·¥å…·** (`read-tool.md`) - æ™ºèƒ½æ–‡ä»¶è¯»å–ï¼Œæ”¯æŒå¤šç¼–ç ã€ç±»å‹æ£€æµ‹ã€readFileStateè¿½è¸ª
2. **Writeå·¥å…·** (`write-tool.md`) - å®‰å…¨æ–‡ä»¶å†™å…¥ï¼Œå¼ºåˆ¶è¯»å–éªŒè¯ã€åŸå­æ“ä½œ
3. **Editå·¥å…·** (`edit-tool.md`) - â­ 9å±‚éªŒè¯æœºåˆ¶çš„ç²¾ç¡®æ–‡ä»¶ç¼–è¾‘ç³»ç»Ÿ
4. **MultiEditå·¥å…·** - æ‰¹é‡æ–‡ä»¶ç¼–è¾‘ï¼Œäº‹åŠ¡æ€§æ“ä½œä¿éšœ

### ç³»ç»Ÿæ“ä½œå·¥å…·
5. **Bashå·¥å…·** (`bash-tool.md`) - å®‰å…¨shellå‘½ä»¤æ‰§è¡Œï¼Œæ²™ç®±ç¯å¢ƒã€è¶…æ—¶æ§åˆ¶
6. **LSå·¥å…·** - ç›®å½•åˆ—ä¸¾ï¼Œè·¯å¾„éªŒè¯ã€æƒé™æ£€æŸ¥
7. **Globå·¥å…·** - æ–‡ä»¶æ¨¡å¼åŒ¹é…ï¼Œé«˜æ€§èƒ½æ–‡ä»¶æŸ¥æ‰¾
8. **Grepå·¥å…·** - å†…å®¹æœç´¢ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ”¯æŒã€æ€§èƒ½ä¼˜åŒ–

### ç½‘ç»œé€šä¿¡å·¥å…·
9. **WebFetchå·¥å…·** - HTTPè¯·æ±‚å¤„ç†ï¼Œå†…å®¹æ¸…ç†ã€ç¼“å­˜æœºåˆ¶
10. **WebSearchå·¥å…·** - æœç´¢å¼•æ“é›†æˆï¼Œç»“æœè¿‡æ»¤ã€ç›¸å…³æ€§æ’åº

### ä»»åŠ¡ç®¡ç†å·¥å…·
11. **Taskå·¥å…·** (`task-tool.md`) - â­ åˆ†å±‚å¤šAgentæ¶æ„çš„æ ¸å¿ƒå®ç°
12. **TodoReadå·¥å…·** - ä»»åŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼ŒçŠ¶æ€è·Ÿè¸ª
13. **TodoWriteå·¥å…·** - ä»»åŠ¡ç®¡ç†ï¼Œä¼˜å…ˆçº§è°ƒåº¦

### ä¸“ç”¨å·¥å…·
14. **NotebookReadå·¥å…·** - Jupyterç¬”è®°æœ¬è¯»å–ï¼Œæ ¼å¼è§£æ
15. **NotebookEditå·¥å…·** - Jupyterç¬”è®°æœ¬ç¼–è¾‘ï¼Œç‰ˆæœ¬æ§åˆ¶

## ğŸ—ï¸ å·¥å…·ç³»ç»Ÿæ¶æ„

### åˆ†å±‚æ¶æ„è®¾è®¡
```mermaid
flowchart TD
    A[Agent Core] --> B[Tool Dispatcher]
    B --> C[Tool Registry]
    B --> D[Execution Controller]
    
    C --> E[Built-in Tools]
    C --> F[MCP Tools]
    C --> G[Plugin Tools]
    
    D --> H[Concurrency Manager]
    D --> I[Security Validator]
    D --> J[Resource Monitor]
    
    E --> K[File Tools]
    E --> L[System Tools]
    E --> M[Network Tools]
    E --> N[Task Tools]
```

### æ ¸å¿ƒç»„ä»¶èŒè´£

#### å·¥å…·è°ƒåº¦å™¨ (Tool Dispatcher)
- **åŠŸèƒ½**: è§£æå·¥å…·è°ƒç”¨è¯·æ±‚ï¼Œåˆ†ç»„æ‰§è¡Œç­–ç•¥ï¼Œç»“æœèšåˆ
- **ç‰¹æ€§**: æ™ºèƒ½åˆ†ç»„ã€å¹¶å‘ä¼˜åŒ–ã€é”™è¯¯éš”ç¦»
- **æ€§èƒ½**: è°ƒåº¦å»¶è¿Ÿ<10msï¼Œæ”¯æŒ1000+å¹¶å‘å·¥å…·è°ƒç”¨

#### æ‰§è¡Œæ§åˆ¶å™¨ (Execution Controller)
- **åŠŸèƒ½**: å·¥å…·ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œèµ„æºåˆ†é…ï¼Œå®‰å…¨æ§åˆ¶
- **ç‰¹æ€§**: è¶…æ—¶æ§åˆ¶ã€èµ„æºé™åˆ¶ã€æƒé™éªŒè¯
- **å®‰å…¨**: æ²™ç®±éš”ç¦»ã€æƒé™æœ€å°åŒ–ã€å®¡è®¡æ—¥å¿—

#### å¹¶å‘ç®¡ç†å™¨ (Concurrency Manager)
- **åŠŸèƒ½**: å¹¶å‘å®‰å…¨åˆ†æï¼Œæ‰§è¡Œé¡ºåºä¼˜åŒ–ï¼Œæ­»é”é¢„é˜²
- **ç®—æ³•**: åŸºäºä¾èµ–åˆ†æçš„æ™ºèƒ½è°ƒåº¦ç®—æ³•
- **é™åˆ¶**: æœ€å¤§å¹¶å‘æ•°10ï¼Œå•å·¥å…·è¶…æ—¶60ç§’

## ğŸ”§ å·¥å…·å®ç°æ ‡å‡†

### å·¥å…·åŸºç±»æ¥å£
```typescript
export abstract class BaseTool<TInput = unknown, TOutput = unknown> {
  abstract name: string;
  abstract description: string;
  abstract inputSchema: JSONSchema;
  
  // æ ¸å¿ƒæ‰§è¡Œæ–¹æ³•
  abstract call(
    input: TInput, 
    context: ToolExecutionContext
  ): AsyncGenerator<ToolResult<TOutput>>;
  
  // å®‰å…¨æ€§æ£€æŸ¥
  abstract validateInput(input: TInput): Promise<ValidationResult>;
  abstract checkPermissions(context: SecurityContext): Promise<PermissionResult>;
  
  // å¹¶å‘æ§åˆ¶
  abstract isConcurrencySafe(input?: TInput): boolean;
  abstract isReadOnly(): boolean;
  
  // èµ„æºç®¡ç†
  abstract estimateResourceUsage(input: TInput): ResourceEstimate;
  abstract cleanup(): Promise<void>;
}
```

### éªŒè¯æœºåˆ¶æ¡†æ¶
```typescript
// 9å±‚éªŒè¯æœºåˆ¶æŠ½è±¡
export abstract class ValidationFramework {
  // ç¬¬1å±‚ï¼šå‚æ•°ä¸€è‡´æ€§éªŒè¯
  abstract validateParameterConsistency(input: unknown): ValidationResult;
  
  // ç¬¬2å±‚ï¼šè·¯å¾„æƒé™éªŒè¯
  abstract validatePathPermissions(path: string): ValidationResult;
  
  // ç¬¬3å±‚ï¼šä¸šåŠ¡é€»è¾‘éªŒè¯
  abstract validateBusinessLogic(input: unknown, context: Context): ValidationResult;
  
  // ç¬¬4-9å±‚ï¼šå…·ä½“å·¥å…·å®ç°
  abstract performCustomValidation(
    input: unknown, 
    context: Context
  ): Promise<ValidationResult>;
}
```

## âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å¹¶å‘æ‰§è¡Œä¼˜åŒ–
```algorithm
å·¥å…·å¹¶å‘è°ƒåº¦ç®—æ³•ï¼š
1. åˆ†æå·¥å…·è°ƒç”¨ä¾èµ–å…³ç³»
   - è¯†åˆ«è¯»å†™æ–‡ä»¶å†²çª
   - åˆ†æç³»ç»Ÿèµ„æºç«äº‰
   - æ£€æµ‹ç¯å¢ƒå˜é‡ä¾èµ–

2. æ„å»ºæ‰§è¡Œè®¡åˆ’
   - åˆ†ç»„æ— ä¾èµ–å·¥å…·ï¼ˆå¹¶å‘æ‰§è¡Œï¼‰
   - æ’åºæœ‰ä¾èµ–å·¥å…·ï¼ˆä¸²è¡Œæ‰§è¡Œï¼‰
   - ä¼˜åŒ–æ‰§è¡Œé¡ºåºï¼ˆæœ€çŸ­è·¯å¾„ï¼‰

3. åŠ¨æ€è´Ÿè½½å‡è¡¡
   - ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨
   - è°ƒæ•´å¹¶å‘æ‰§è¡Œæ•°é‡
   - å®æ—¶ä¼˜åŒ–æ‰§è¡Œç­–ç•¥

4. é”™è¯¯æ¢å¤æœºåˆ¶
   - å¤±è´¥å·¥å…·é‡è¯•ç­–ç•¥
   - ä¾èµ–å·¥å…·çº§è”å¤„ç†
   - éƒ¨åˆ†å¤±è´¥å®¹å¿æœºåˆ¶
```

### èµ„æºä½¿ç”¨ä¼˜åŒ–
- **å†…å­˜ç®¡ç†**: å·¥å…·ç»“æœæµå¼å¤„ç†ï¼Œå¤§æ–‡ä»¶åˆ†å—è¯»å–ï¼ŒåŠæ—¶é‡Šæ”¾èµ„æº
- **CPUä¼˜åŒ–**: è®¡ç®—å¯†é›†å‹å·¥å…·ä½¿ç”¨Workerçº¿ç¨‹ï¼ŒI/Oå¯†é›†å‹å·¥å…·ä½¿ç”¨å¼‚æ­¥é˜Ÿåˆ—
- **ç½‘ç»œä¼˜åŒ–**: HTTPè¯·æ±‚è¿æ¥æ± ï¼Œæ™ºèƒ½é‡è¯•æœºåˆ¶ï¼Œç¼“å­˜ç­–ç•¥

## ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶è®¾è®¡

### Editå·¥å…·9å±‚éªŒè¯è¯¦è§£
åŸºäºClaude Codeé€†å‘åˆ†æçš„æ ¸å¿ƒå®‰å…¨æœºåˆ¶ï¼š

```algorithm
9å±‚éªŒè¯æœºåˆ¶æ‰§è¡Œæµç¨‹ï¼š
å±‚1: å‚æ•°ä¸€è‡´æ€§ â†’ éªŒè¯old_string != new_string
å±‚2: è·¯å¾„éªŒè¯ â†’ è§„èŒƒåŒ–è·¯å¾„ï¼Œæ£€æŸ¥æƒé™å’Œé»‘åå•
å±‚3: æ–‡ä»¶åˆ›å»º â†’ å¤„ç†æ–°æ–‡ä»¶åˆ›å»ºçš„ç‰¹æ®Šé€»è¾‘
å±‚4: åˆ›å»ºè®¸å¯ â†’ éªŒè¯æ–°æ–‡ä»¶åˆ›å»ºæƒé™
å±‚5: å­˜åœ¨æ€§éªŒè¯ â†’ ç¡®è®¤ç›®æ ‡æ–‡ä»¶å­˜åœ¨
å±‚6: ç±»å‹æ£€æŸ¥ â†’ Jupyteræ–‡ä»¶ç±»å‹ç‰¹æ®Šå¤„ç†
å±‚7: å¼ºåˆ¶è¯»å– â†’ â­ æ ¸å¿ƒï¼šéªŒè¯readFileStateå­˜åœ¨
å±‚8: æ—¶é—´éªŒè¯ â†’ æ£€æŸ¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œé˜²æ­¢å¹¶å‘å†²çª
å±‚9: å­—ç¬¦ä¸²éªŒè¯ â†’ éªŒè¯ç›®æ ‡å­—ç¬¦ä¸²å­˜åœ¨æ€§å’Œå”¯ä¸€æ€§
```

### æƒé™æ§åˆ¶ä½“ç³»
```typescript
export interface PermissionMatrix {
  // æ–‡ä»¶æ“ä½œæƒé™
  fileRead: Set<string>;        // å¯è¯»è·¯å¾„ç™½åå•
  fileWrite: Set<string>;       // å¯å†™è·¯å¾„ç™½åå•
  fileCreate: Set<string>;      // å¯åˆ›å»ºè·¯å¾„ç™½åå•
  
  // ç³»ç»Ÿæ“ä½œæƒé™
  commandWhitelist: Set<string>; // å…è®¸çš„å‘½ä»¤åˆ—è¡¨
  networkAccess: boolean;        // ç½‘ç»œè®¿é—®æƒé™
  environmentAccess: Set<string>; // ç¯å¢ƒå˜é‡è®¿é—®æƒé™
  
  // èµ„æºä½¿ç”¨é™åˆ¶
  maxMemoryUsage: number;        // æœ€å¤§å†…å­˜ä½¿ç”¨ï¼ˆå­—èŠ‚ï¼‰
  maxExecutionTime: number;      // æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  maxFileSize: number;           // æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
}
```

## ğŸ”Œ MCPåè®®é›†æˆ

### MCPå·¥å…·æ¡¥æ¥å™¨
```typescript
export class MCPToolBridge {
  // MCPæœåŠ¡å™¨ç®¡ç†
  async registerMCPServer(config: MCPServerConfig): Promise<void>;
  async loadMCPTools(serverName: string): Promise<Tool[]>;
  
  // åè®®è½¬æ¢
  async convertMCPToolCall(
    mcpCall: MCPToolCall
  ): Promise<InternalToolCall>;
  
  async convertMCPResult(
    mcpResult: MCPResult
  ): Promise<ToolResult>;
  
  // ç”Ÿå‘½å‘¨æœŸç®¡ç†
  async startMCPServers(): Promise<void>;
  async stopMCPServers(): Promise<void>;
}
```

### æ’ä»¶å¼€å‘æ¡†æ¶
```typescript
export interface PluginTool extends BaseTool {
  // æ’ä»¶å…ƒæ•°æ®
  pluginName: string;
  pluginVersion: string;
  author: string;
  
  // æ’ä»¶ç”Ÿå‘½å‘¨æœŸ
  onInstall(): Promise<void>;
  onUninstall(): Promise<void>;
  onUpdate(oldVersion: string): Promise<void>;
  
  // æ’ä»¶é…ç½®
  getConfigSchema(): JSONSchema;
  configure(config: unknown): Promise<void>;
}
```

## ğŸ“Š ç›‘æ§ä¸è¯Šæ–­

### å·¥å…·æ‰§è¡ŒæŒ‡æ ‡
- **æ€§èƒ½æŒ‡æ ‡**: æ‰§è¡Œæ—¶é—´ã€å†…å­˜ä½¿ç”¨ã€CPUå ç”¨ã€I/Oæ“ä½œæ¬¡æ•°
- **è´¨é‡æŒ‡æ ‡**: æˆåŠŸç‡ã€é”™è¯¯ç‡ã€é‡è¯•æ¬¡æ•°ã€éªŒè¯é€šè¿‡ç‡
- **å®‰å…¨æŒ‡æ ‡**: æƒé™æ£€æŸ¥æ¬¡æ•°ã€å®‰å…¨è¿è§„æ¬¡æ•°ã€æ²™ç®±é€ƒé€¸å°è¯•

### å®æ—¶ç›‘æ§é¢æ¿
```typescript
export interface ToolMonitoringDashboard {
  // å®æ—¶æŒ‡æ ‡
  getCurrentMetrics(): ToolExecutionMetrics;
  
  // å†å²æ•°æ®
  getHistoricalData(timeRange: TimeRange): HistoricalMetrics[];
  
  // å‘Šè­¦ç³»ç»Ÿ
  subscribeToAlerts(callback: (alert: Alert) => void): () => void;
  
  // æ€§èƒ½åˆ†æ
  generatePerformanceReport(): PerformanceReport;
}
```

## ğŸ§ª æµ‹è¯•éªŒè¯ä½“ç³»

### å•å…ƒæµ‹è¯•æ ‡å‡†
- **å·¥å…·åŠŸèƒ½æµ‹è¯•**: æ¯ä¸ªå·¥å…·çš„æ ¸å¿ƒåŠŸèƒ½éªŒè¯ï¼Œè¾¹ç•Œæ¡ä»¶å¤„ç†
- **å®‰å…¨æµ‹è¯•**: æƒé™ç»•è¿‡å°è¯•ï¼Œæ¶æ„è¾“å…¥å¤„ç†ï¼Œæ²™ç®±é€ƒé€¸æµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**: è´Ÿè½½æµ‹è¯•ï¼Œå¹¶å‘æµ‹è¯•ï¼Œèµ„æºä½¿ç”¨æµ‹è¯•
- **å…¼å®¹æ€§æµ‹è¯•**: ä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒNode.jsç‰ˆæœ¬ï¼Œä¸åŒä¾èµ–ç‰ˆæœ¬

### é›†æˆæµ‹è¯•æ¡†æ¶
```typescript
export class ToolIntegrationTestSuite {
  // å·¥å…·åä½œæµ‹è¯•
  async testToolCoordination(): Promise<TestResult>;
  
  // å¹¶å‘å®‰å…¨æµ‹è¯•
  async testConcurrencySafety(): Promise<TestResult>;
  
  // é”™è¯¯æ¢å¤æµ‹è¯•
  async testErrorRecovery(): Promise<TestResult>;
  
  // æ€§èƒ½åŸºå‡†æµ‹è¯•
  async benchmarkPerformance(): Promise<BenchmarkResult>;
}
```

## ğŸš€ æœªæ¥æ‰©å±•æ–¹å‘

### æ™ºèƒ½å·¥å…·æ¨è
åŸºäºç”¨æˆ·è¡Œä¸ºå’Œä¸Šä¸‹æ–‡çš„æ™ºèƒ½å·¥å…·æ¨èç³»ç»Ÿï¼Œæå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

### åˆ†å¸ƒå¼å·¥å…·æ‰§è¡Œ
æ”¯æŒè·¨æœºå™¨çš„åˆ†å¸ƒå¼å·¥å…·æ‰§è¡Œï¼Œå¤„ç†å¤§è§„æ¨¡å¹¶è¡Œä»»åŠ¡å’Œè®¡ç®—å¯†é›†å‹æ“ä½œã€‚

### AIè¾…åŠ©å·¥å…·å¼€å‘
ä½¿ç”¨AIè¾…åŠ©ç”Ÿæˆæ–°å·¥å…·ï¼Œè‡ªåŠ¨åŒ–å·¥å…·æµ‹è¯•å’Œä¼˜åŒ–ï¼Œæ™ºèƒ½å·¥å…·ç»„åˆã€‚

---

*å·¥å…·å®ç°ç³»ç»Ÿæ˜¯Claude Codeæ ¸å¿ƒèƒ½åŠ›çš„å…·ä½“ä½“ç°ï¼Œé€šè¿‡ç²¾ç¡®è¿˜åŸæ¯ä¸ªå·¥å…·çš„å®ç°ç»†èŠ‚å’Œå®‰å…¨æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿçš„å¯é æ€§ã€å®‰å…¨æ€§å’Œé«˜æ€§èƒ½ã€‚æ¯ä¸ªå·¥å…·éƒ½ç»è¿‡ä¸¥æ ¼çš„é€†å‘åˆ†æéªŒè¯ï¼Œä»£è¡¨äº†AIç¼–ç¨‹åŠ©æ‰‹é¢†åŸŸçš„æŠ€æœ¯æ ‡æ†ã€‚*